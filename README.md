# 机械大师（MachineMaster）代码仓库
## 仓库介绍
该仓库包含了工程中的部分代码（不是所有）；
仓库未上传编辑器脚本，美术资源，meta文件以及工程内置文件；

## 游戏介绍
游戏类型为2D横板关卡游戏。  
玩法：玩家在每一个关卡都需要解决一些机物理械配合问题，比如如何通过一个坑，如何让两个齿轮能够实现传动，如何让一个平台能够升降。  
* 玩家可以操控自己扮演的机器人角色进行移动和观察。
* 玩家可以利用节点的方式，进行钢材框架设计。
* 可以进行场景其他零件创建和放置，让零件相互配合形成机械结构，如啮合的齿轮，减震弹簧，转动的电机，推动的液压器，飞行的喷气发动机。
* 玩家可以对已创建的零件进行焊接（FixedJoint）或者铰接（HingeJoint）。从而使得零件可以传动或配合。
* 还可以对一些零件进行可视化编程，如控制液压器的伸缩，电机转子的转速，喷气发动机的动力和转角。可视化编程包含多种类型节点（输入类型，运算类型，逻辑类型，传感器类型）。
* 还可以放置各种传感器，获取距离，角度，速度的数值用以可视化编程。在可视化编程时可以选择使用的传感器。
* 玩家可以保存每一个关卡的设计结果和可视化编程的内容，Steam客户端可自动上传到云存档，可以在不同的设备使用这些存档。
* 设计了部分Steam成就和统计功能。

## 做了什么
* 对于2D物理对象碰撞：物理模拟使用Unity内置的2D物理系统（Box2D）。在性能优化上主要是采用基础碰撞器，分步创建物理对象，合并碰撞器，检测代码使用无GC方式，间隔式检测等。
* 对于放置功能：设计了自动吸附功能，如齿轮啮合媳妇，位置上的水平垂直吸附，关键点的吸附。  
* 对于可视化编程：采用根节点为起点递归方式计算结果，并控制可编程零件的行为。  
* 对于零件的铰接：采用鼠标位置检测，层级选择，纯色效果的区分。
* 对象选择优化：重叠的物体采用了类似Unity编辑的选择方案，使用栈的结构来逐步选择被覆盖的对象。
* 运行模式和模拟模式：游戏在设计模式下关闭物理模拟，玩家设计零件和机械配合。开始物理模式后，关闭编辑功能，启用物理时间，创建设计零件并激活其物理组件。

## 游戏截图
### 关卡1
![预览图](https://github.com/LYN-lynn/MachineMaster/blob/main/%E7%94%B5%E6%A2%AF%E5%85%B3%E5%8D%A1%E6%88%AA%E5%9B%BE.png)
![预览图](建模.png)
![预览图](关卡截图.png)
